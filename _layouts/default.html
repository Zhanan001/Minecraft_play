<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        {% if page.title %}{{ page.title }} | {% endif %}{{ site.title | default: "文档站点" }}
    </title>
    <style>
        /* ===== 基础重置与全局样式 ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #fff;
            display: flex;
            min-height: 100vh;
        }

        /* ===== 侧边导航栏样式 ===== */
        .sidebar {
            width: 300px;
            background: #fafbfc;
            border-right: 1px solid #e1e4e8;
            padding: 24px 0;
            flex-shrink: 0;
            overflow-y: auto;
            max-height: 100vh;
            position: sticky;
            top: 0;
        }

        .sidebar-header {
            padding: 0 24px 20px 24px;
            border-bottom: 1px solid #eaecef;
            margin-bottom: 16px;
        }

        .site-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #24292e;
            text-decoration: none;
        }

        .site-title:hover {
            color: #0366d6;
        }

        .site-description {
            font-size: 0.9rem;
            color: #586069;
            margin-top: 4px;
        }

        .nav-section {
            margin-bottom: 8px;
        }

        .nav-category {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: #6a737d;
            padding: 8px 24px;
            margin-top: 16px;
        }

        .nav-list {
            list-style: none;
            padding-left: 0;
        }

        .nav-item {
            display: block;
        }

        .nav-link {
            display: block;
            padding: 6px 24px;
            color: #24292e;
            text-decoration: none;
            font-size: 0.95rem;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .nav-link:hover {
            background-color: #f6f8fa;
            color: #0366d6;
            border-left-color: #d1d5da;
        }

        .nav-link.active {
            font-weight: 600;
            color: #0366d6;
            background-color: #f1f8ff;
            border-left-color: #0366d6;
        }

        /* ===== 主内容区样式 ===== */
        .content {
            flex: 1;
            padding: 40px 48px;
            max-width: 900px;
            min-width: 0; /* 确保flex布局可收缩 */
        }

        .content-header {
            border-bottom: 1px solid #eaecef;
            padding-bottom: 20px;
            margin-bottom: 32px;
        }

        .content-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #24292e;
            margin-bottom: 8px;
        }

        .content-body {
            font-size: 16px;
        }

        .content-body h1,
        .content-body h2,
        .content-body h3 {
            margin-top: 1.5em;
            margin-bottom: 0.8em;
            font-weight: 600;
            color: #24292e;
        }

        .content-body h1 {
            font-size: 1.8rem;
            padding-bottom: 0.3em;
            border-bottom: 1px solid #eaecef;
        }

        .content-body h2 {
            font-size: 1.5rem;
        }

        .content-body p {
            margin-bottom: 1em;
        }

        .content-body a {
            color: #0366d6;
            text-decoration: none;
        }

        .content-body a:hover {
            text-decoration: underline;
        }

        .content-body code {
            background-color: #f6f8fa;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;
            font-size: 0.9em;
        }

        .content-body pre {
            background-color: #f6f8fa;
            padding: 1em;
            overflow: auto;
            border-radius: 3px;
            margin: 1em 0;
        }

        /* ===== 响应式设计：移动端适配 ===== */
        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                max-height: 40vh;
                position: relative;
                border-right: none;
                border-bottom: 1px solid #e1e4e8;
            }

            .content {
                padding: 24px;
            }

            .content-title {
                font-size: 1.8rem;
            }
        }

        /* ===== 页脚样式 ===== */
        .footer {
            margin-top: 48px;
            padding-top: 20px;
            border-top: 1px solid #eaecef;
            font-size: 0.85rem;
            color: #6a737d;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- 侧边导航栏 -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="{{ '/' | relative_url }}" class="site-title">
                {{ site.title | default: "文档中心" }}
            </a>
            {% if site.description %}
            <p class="site-description">{{ site.description }}</p>
            {% endif %}
        </div>

        <!-- 导航生成核心逻辑 -->
        <nav>
            <!-- 获取所有唯一的目录 -->
            {% assign all_dirs = site.html_pages | map: 'dir' | uniq | sort %}

            {% for dir in all_dirs %}
                {% assign pages_in_dir = site.html_pages | where: 'dir', dir | sort: 'nav_order' | sort: 'title' %}

                {% if pages_in_dir.size > 0 %}
                    {% assign dir_name = dir | remove: '/' %}

                    <!-- 解码URL编码的中文目录名 -->
                    {% if dir_name contains '%' %}
                        {% assign dir_name = dir_name | uri_decode %}
                    {% endif %}

                    <!-- 移除排序数字前缀（如“01-”） -->
                    {% assign dir_name = dir_name | replace_regex: '^\d+\s*[-.]\s*', '' %}

                    <!-- 如果目录名为空（根目录），则跳过分类显示 -->
                    {% if dir_name != '' %}
                        <div class="nav-category">{{ dir_name }}</div>
                    {% endif %}

                    <ul class="nav-list">
                        {% for p in pages_in_dir %}
                            <!-- 排除导航页本身 -->
                            {% unless p.nav_exclude %}
                                {% assign page_title = p.title | default: p.name | replace: '.md', '' %}
                                <li class="nav-item">
                                    <a href="{{ p.url | relative_url }}"
                                       class="nav-link {% if p.url == page.url %}active{% endif %}">
                                        {{ page_title }}
                                    </a>
                                </li>
                            {% endunless %}
                        {% endfor %}
                    </ul>
                {% endif %}
            {% endfor %}
        </nav>
    </aside>

    <!-- 主内容区域 -->
    <main class="content">
        <header class="content-header">
            <h1 class="content-title">{{ page.title }}</h1>
            {% if page.description %}
            <p class="content-description">{{ page.description }}</p>
            {% endif %}
        </header>

        <article class="content-body">
            {{ content }}
        </article>

        <footer class="footer">
            <p>最后更新: {{ site.time | date: "%Y-%m-%d" }} | 
               使用 <a href="https://pages.github.com" target="_blank">GitHub Pages</a> 与 Jekyll 构建
            </p>
        </footer>
    </main>

    <!-- 简单的当前页面高亮脚本 -->
    <script>
        // 根据当前URL高亮导航栏中的对应链接
        document.addEventListener('DOMContentLoaded', function() {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link');

            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentPath) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>

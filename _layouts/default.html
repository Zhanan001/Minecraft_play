<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>{{ site.title }} - {{ page.title }}</title>
    <style>
        /* 基础样式，你可以根据喜好修改 */
        body { display: flex; margin: 0; font-family: sans-serif; }
        .sidebar {
            width: 280px;
            height: 100vh;
            overflow-y: auto;
            background: #f5f5f5;
            padding: 20px;
            box-sizing: border-box;
            border-right: 1px solid #ddd;
        }
        .sidebar ul { list-style: none; padding-left: 15px; }
        .sidebar li { margin: 8px 0; }
        .sidebar a { text-decoration: none; color: #333; }
        .sidebar a:hover { color: #0366d6; }
        .content { flex: 1; padding: 40px; max-width: 900px; }
        /* 区分目录标题和文件链接 */
        .dir-title { color: #666; font-weight: bold; margin-top: 20px; font-size: 1.1em; }
        .dir-title:first-child { margin-top: 0; }
        .file-link { color: #0366d6; }
    </style>
</head>
<body>
    <!-- 侧边栏导航开始 -->
    <nav class="sidebar">
        <ul>
            <!-- 步骤1：获取所有目录 -->
            {% assign all_dirs = site.html_pages | map: 'dir' | uniq | sort %}

            <!-- 步骤2：遍历每一个唯一的目录 -->
            {% for dir in all_dirs %}
                <!-- 步骤3：获取属于当前目录的所有页面，并按 nav_order 排序 -->
                {% assign pages_in_dir = site.html_pages | where: 'dir', dir | sort: 'nav_order' %}
                
                <!-- 只有当这个目录下真的有页面时，我们才生成一个目录组 -->
                {% if pages_in_dir.size > 0 %}
                    <li class="dir-title">
                        <!-- 显示目录名，可以用更友好的名字替换，这里显示原始路径 -->
                        {{ dir | remove: '/' | default: '根目录' }}
                    </li>
                    <!-- 步骤4：列出该目录下的所有页面 -->
                    <ul>
                        {% for p in pages_in_dir %}
                        <li>
                            <a class="file-link" href="{{ p.url | relative_url }}">
                                <!-- 如果页面有自定义标题就用，否则用文件名 -->
                                {{ p.title | default: p.name }}
                            </a>
                        </li>
                        {% endfor %}
                    </ul>
                {% endif %}
            {% endfor %}
        </ul>
    </nav>
    <!-- 侧边栏导航结束 -->

    <!-- 主内容区 -->
    <main class="content">
        {{ content }}
    </main>
</body>
</html>
